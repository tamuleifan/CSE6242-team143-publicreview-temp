<!DOCTYPE html>
<html lang="en">
<script src="https://fastcdn.org/Papa-Parse/4.1.2/papaparse.min.js"></script>
<script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>A quick demo</title>
    <link href="style.css" type="text/css" rel="stylesheet"/>
    <link href="main.css" type="text/css" rel="stylesheet"/>
</head>

<script>
    var crimeURL = "https://data.cityofnewyork.us/resource/9s4h-37hy.json?$limit=1000000"; //totalling 468,988 rows
    var apiCall = crimeURL 
        + "&$where="
        + "rpt_dt between \'2017-01-01T00:00:00\' and \'2018-01-01T00:00:00\'"
        + " AND latitude between " + bounds.bottom + " and " + bounds.top
        + " AND longitude between " + bounds.left + " and " + bounds.right
        + " AND law_cat_cd in(\'FELONY\', \'VIOLATION\')";

    var crimeOnMap = [];
    $.getJSON(apiCall, function(data) {
        data.forEach(function(d){
            crimeOnMap.push(
                new google.maps.LatLng(+d['latitude'], +d['longitude'])
                /*{
                year: +d['rpt_dt'.substr(0,4)],
                law_cat_cd: d['law_cat_cd'],
                VIC_AGE_GROUP: d['VIC_AGE_GROUP'],
                VIC_SEX: d['VIC_SEX'],
                lat: +d['latitude'],
                lng: +d['longitude']
                }*/
            );
        });
    }).done(function(d) {console.log(dataset[0]);});
    

    /*$.ajax({
        url: "apiCall",
        type: "GET",
        data: {
        "$limit" : 5000,
        "$$app_token" : "JkzrSg4DSpmxZAXkTA2RWWcuq"
        }
    }).done(function(data) {
    alert("Retrieved " + data.length + " records from the dataset!");
    console.log(data);
    });*/
</script>